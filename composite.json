{
  "name": "create-do-project-and-firewall",
  "version": "0.0.1",
  "description": "Create a DigitalOcean project, then create a firewall (via WASM).",
  "inputs": [
    { "name": "do_token",        "type": "string", "description": "DigitalOcean access token" },
    { "name": "do_project_name", "type": "string", "description": "Project name" },
    { "name": "firewall_name",   "type": "string", "description": "Firewall name", "default": "default-firewall" }
  ],
  "outputs": [
    { "name": "project_id",    "type": "string", "description": "ID of the created project" },
    { "name": "firewall_name", "type": "string", "description": "Name of the created firewall" }
  ],
  "steps": [
    {
      "id": "create_project",
      "uses": "ghcr.io/starthubhq/create-do-project-docker:0.0.3",
      "with": {}
    },
    {
      "id": "create_firewall",
      "kind": "wasm",
      "uses": "https://github.com/starthubhq/create-do-firewall-wasm/releases/download/v0.0.11/module.wasm",
      "with": {}
    }
  ],
  "wires": [
    { "from": { "source": "inputs", "key": "do_token"       }, "to": { "step": "create_project",  "input": "do_access_token" } },
    { "from": { "source": "inputs", "key": "do_project_name" }, "to": { "step": "create_project",  "input": "do_project_name" } },

    { "from": { "source": "inputs", "key": "do_token"       }, "to": { "step": "create_firewall", "input": "do_token" } },
    { "from": { "source": "inputs", "key": "firewall_name"  }, "to": { "step": "create_firewall", "input": "name" } }
  ],
  "export": {
    "project_id":    { "from": { "step": "create_project",  "output": "project_id" } },
    "firewall_name": { "from": { "source": "inputs", "key": "firewall_name" } }
  }
}
